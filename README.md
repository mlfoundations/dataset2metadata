# dataset2metadata
[![pypi](https://img.shields.io/pypi/v/img2dataset.svg)](https://pypi.python.org/pypi/dataset2metadata)

Process a downloaded dataset (currently a [webdataset](https://github.com/webdataset/webdataset) generated by [img2dataset](https://github.com/rom1504/img2dataset)) with arbitrary models. Currently the default workload supports the metadata processing workload of DataComp.

## Example .yml

```yaml
models: # model directives, specifying the models to instantiate
  - oai-clip-vit-b32
  - oai-clip-vit-l14
  - nsfw-detoxify
  - nsfw-image-oai-clip-vit-l-14
  # - faces-scrfd10g
  - dedup-isc-ft-v107
postprocess_columns: # postprocessing directives
  - oai-clip-vit-b32-score
  - oai-clip-vit-l14-score
  - nsfw-detoxify-score
  - nsfw-image-score
  - dedup-isc-ft-v107-score
postprocess_features: # saved in an npz format
  - oai-clip-vit-b32-image
  - oai-clip-vit-b32-text
  - oai-clip-vit-l14-image
  - oai-clip-vit-l14-text
  - dedup-isc-ft-v107-image
additional_fields: # fields in a webdataset json to carry over into the metadata
  - uid
  - url
  - caption
  - original_width
  - original_height
  - sha256
nworkers: 2
batch_size: 512
device: 0
input_tars: "/admin/home-sy/repos/dataset2metadata/tests/tar_test_files/00005717.tar" # brace expand suported
output_metadata_dir: "/admin/home-sy/repos/dataset2metadata/tests/test_out" # can be arbitrary path
custom_models_pypath: null # if model not known, look in this python file for implementation
custom_postprocess_pypath: null # if posprocess not known, look in this python file for implementation
```